# Note: This is a full specification, but only paths are actually used.
# Any refs are rewritten as absolute file uris.
---
swagger: "2.0"
paths:
  /biblios/{biblio_id}/{display}:
    get:
      x-mojo-to: "Oxlit::Browse::Controllers::BiblioController#get"
      operationId: GetBiblio
      tags:
        - biblios
      produces:
        - application/json
      parameters:
        - name: biblio_id
          in: path
          required: true
          type: integer
          description: The unique identifier for the biblio record
        - name: display
          in: path
          required: true
          type: string
          enum:
            - brief
            - full
      responses:
        200:
          description: Biblio record retrieved successfully
          schema:
            $ref: ./openapi/definitions.yaml#/biblio-full
        404:
          description: Biblio not found
          schema:
            $ref: ./openapi/definitions.yaml#/error
  /biblios/advancedsearch:
    get:
      x-mojo-to: "Oxlit::Browse::Controllers::BibliosAdvancedSearchController#list"
      operationId: ListAdvancedSearchBiblios
      tags:
        - advancedsearch
      produces:
        - application/json
      parameters:
        - name: search_in[]
          collectionFormat: multi
          in: query
          description: Search in
          required: true
          type: array
          items:
            type: string
            enum:
              - au
              - au_phr
              - itemtype
              - kw
              - kw_phr
              - ln
              - ln_rtrn
              - pb
              - se
              - su
              - su_phr
              - subject-name-personal
              - ti
              - ti_phr
        - name: page
          in: query
          description: Page number
          required: false
          type: integer
        - name: per_page
          in: query
          description: Number of items per page
          required: false
          type: integer
        - name: q[]
          collectionFormat: multi
          in: query
          description: Search query
          required: true
          type: array
          items:
            type: string
        - name: sort_by
          in: query
          description: Sort order (title_az or title_za)
          required: false
          type: string
          enum:
            - author_az
            - pubdate_dsc
            - title_az
      responses:
        200:
          description: A List of biblios
          schema:
            type: object
            properties:
              biblios:
                $ref: ./openapi/definitions.yaml#/biblios
              pagination:
                $ref: ./openapi/definitions.yaml#/pagination
        401:
          description: Authentication required
          schema:
            $ref: ./openapi/definitions.yaml#/error
  /biblios/basicsearch:
    get:
      x-mojo-to: "Oxlit::Browse::Controllers::BibliosBasicSearchController#list"
      operationId: ListBasicSearchBiblios
      tags:
        - basicsearch
      produces:
        - application/json
      parameters:
        - name: search_in
          in: query
          description: Search in
          required: true
          type: string
          enum:
            - au
            - au_phr
            - itemtype
            - kw
            - kw_phr
            - ln
            - ln_rtrn
            - pb
            - pb_phr
            - se
            - su
            - su_phr
            - subject-name-personal
            - ti
            - ti_phr
        - name: page
          in: query
          description: Page number
          required: false
          type: integer
        - name: per_page
          in: query
          description: Number of items per page
          required: false
          type: integer
        - name: q
          in: query
          description: Search query
          required: true
          type: string
        - name: sort_by
          in: query
          description: Sort order (title_az or title_za)
          required: false
          type: string
          enum:
            - author_az
            - pubdate_dsc
            - title_az
      responses:
        200:
          description: A List of biblios
          schema:
            type: object
            properties:
              biblios:
                $ref: ./openapi/definitions.yaml#/biblios
              pagination:
                $ref: ./openapi/definitions.yaml#/pagination
        401:
          description: Authentication required
          schema:
            $ref: ./openapi/definitions.yaml#/error
  /biblios/fastaccess:
    get:
      x-mojo-to: "Oxlit::Browse::Controllers::BibliosFastAccessController#list"
      operationId: ListFastAccessBiblios
      tags:
        - fastaccess
      produces:
        - application/json
      parameters:
        - name: page
          in: query
          description: Page number
          required: false
          type: integer
        - name: per_page
          in: query
          description: Number of items per page
          required: false
          type: integer
        - name: q
          in: query
          description: Search query
          required: true
          type: string
        - name: sort_by
          in: query
          description: Sort order (title_az or title_za)
          required: false
          type: string
          enum:
            - author_az
            - pubdate_dsc
            - title_az
      responses:
        200:
          description: A List of biblios for fast access
          schema:
            type: object
            properties:
              biblios:
                $ref: ./openapi/definitions.yaml#/biblios
              pagination:
                $ref: ./openapi/definitions.yaml#/pagination
        401:
          description: Authentication required
          schema:
            $ref: ./openapi/definitions.yaml#/error
  /browse:
    get:
      x-mojo-to: "Oxlit::Browse::Controllers::BrowseController#list"
      operationId: BrowseByFacets
      tags:
        - browse
      produces:
        - application/json
      parameters:
        - name: page
          in: query
          description: Page number
          required: false
          type: integer
        - name: per_page
          in: query
          description: Number of items per page
          required: false
          type: integer
        - name: starts_with
          in: query
          description: Filter publishers that start with this letter (case insensitive)
          required: false
          type: string
        - name: browse_by
          in: query
          description: Filter results by facet type
          required: true
          type: string
          enum:
            - author
            - authorassubject
            - publisher
            - seriestitle
            - subject
            - title
      responses:
        200:
          description: A List of results based on the selected facet
          schema:
            type: object
            properties:
              results:
                type: array
                items:
                  type: object
                  properties:
                    title:
                      type: string
              pagination:
                $ref: ./openapi/definitions.yaml#/pagination
        400:
          description: Bad Request
          schema:
            $ref: ./openapi/definitions.yaml#/error
        401:
          description: Authentication required
          schema:
            $ref: ./openapi/definitions.yaml#/error
